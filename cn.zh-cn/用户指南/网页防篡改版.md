# 网页防篡改版<a name="hss_01_0214"></a>

开启网页防篡改时，您需为指定的主机分配一个配额，关闭企业主机安全服务或删除主机后，该配额可分配给其他的主机使用。

开启网页防篡改防护时会同步开启主机安全的旗舰版防护。

## 网页防篡改原理<a name="section6586124234917"></a>

**表 1**  网页防篡改原理

<a name="table171301423115020"></a>
<table><thead align="left"><tr id="row101311123165010"><th class="cellrowborder" valign="top" width="17.669999999999998%" id="mcps1.2.3.1.1"><p id="p5131112316508"><a name="p5131112316508"></a><a name="p5131112316508"></a>防护类型</p>
</th>
<th class="cellrowborder" valign="top" width="82.33%" id="mcps1.2.3.1.2"><p id="p101312235504"><a name="p101312235504"></a><a name="p101312235504"></a>原理说明</p>
</th>
</tr>
</thead>
<tbody><tr id="row1213192345010"><td class="cellrowborder" valign="top" width="17.669999999999998%" headers="mcps1.2.3.1.1 "><p id="p191311323115011"><a name="p191311323115011"></a><a name="p191311323115011"></a>静态网页防护</p>
</td>
<td class="cellrowborder" valign="top" width="82.33%" headers="mcps1.2.3.1.2 "><a name="ol2079014295015"></a><a name="ol2079014295015"></a><ol id="ol2079014295015"><li>锁定本地文件目录<p id="p579011429509"><a name="p579011429509"></a><a name="p579011429509"></a>驱动级锁定Web文件目录下的文件，禁止攻击者修改，网站管理员可通过特权进程进行更新网站内容。</p>
</li><li>主动备份恢复<p id="p879014426509"><a name="p879014426509"></a><a name="p879014426509"></a>若检测到防护目录下的文件被篡改时，将立即使用本地主机备份文件自动恢复被非法篡改的文件。</p>
</li><li>远端备份恢复<p id="p77900421506"><a name="p77900421506"></a><a name="p77900421506"></a>若本地主机上的文件目录和备份目录失效，还可通过远端备份服务恢复被篡改的网页。</p>
</li></ol>
</td>
</tr>
<tr id="row11131142385011"><td class="cellrowborder" valign="top" width="17.669999999999998%" headers="mcps1.2.3.1.1 "><p id="p11131122325014"><a name="p11131122325014"></a><a name="p11131122325014"></a>动态网页防护</p>
</td>
<td class="cellrowborder" valign="top" width="82.33%" headers="mcps1.2.3.1.2 "><a name="ol37451749195010"></a><a name="ol37451749195010"></a><ol id="ol37451749195010"><li>基于RASP过滤恶意行为<p id="p15745174925017"><a name="p15745174925017"></a><a name="p15745174925017"></a>采用华为自研RASP检测应用程序行为，有效阻断攻击者通过应用程序篡改网页内容的行为。</p>
</li><li>网盘文件访问控制<p id="p6745649125020"><a name="p6745649125020"></a><a name="p6745649125020"></a>精细化定义网盘文件中的文件访问权限，包括新增，修改，查询等，确保防篡改同时不影响网站内容发布。</p>
</li></ol>
</td>
</tr>
</tbody>
</table>

## 约束条件<a name="section11225204110314"></a>

操作系统类型为Windows的主机在开启防护时，需开启Windows防火墙，使用企业主机安全服务期间请勿关闭Windows防火墙。

## 前提条件<a name="section1167255181511"></a>

-   在“网页防篡改  \>  防护列表“页面中“Agent状态“为“在线“、“防护状态“为“关闭“。
-   在“企业主机安全  \>  主机管理“页面“云服务器“列表中“Agent状态“为“在线“、“防护状态“为“关闭“。
-   已在所选区域内购买了充足可用的“网页防篡改版”配额，[查看配额详情](https://support.huaweicloud.com/hss_faq/hss_01_0156.html#section1)。

## 设置防护目录<a name="section16232142216125"></a>

网页防篡改功能需要有防护目录才能起到防护作用，网页防篡改提供两种目录防护模式：

-   保护指定目录

    您最多可在主机中添加50个防护目录，详细操作请参见[保护指定目录](添加防护目录-文件系统.md#section4367121594314)。

    为实时记录主机中的运行情况，请排除防护目录下Log类型的文件，您可以为日志文件添加等级较高的读写权限，防止攻击者恶意查看或篡改日志文件。

-   保护网络文件系统

    您最多可以添加5个文件系统，详细操作请参见[保护网络文件系统](添加防护目录-文件系统.md#section13115162824912)。

    请确保添加的文件系统不是操作系统所在的系统分区。


## 开启网页防篡改<a name="section640721810126"></a>

1.  [登录管理控制台](https://console.huaweicloud.com)。
2.  在页面上方选择区域后，单击![](figures/icon-servicelist.png)，选择“安全  \>  企业主机安全“。

    **图 1**  企业主机安全<a name="hss_01_0229_fig1271516227232"></a>  
    ![](figures/企业主机安全.png "企业主机安全")

3.  进入“网页防篡改“界面，单击“开启防护“。

    **图 2**  进入“网页防篡改”界面<a name="fig9672155819720"></a>  
    ![](figures/进入-网页防篡改-界面.png "进入-网页防篡改-界面")

    >![](public_sys-resources/icon-note.gif) **说明：** 
    >云服务器列表仅显示以下主机的防护状态：
    >-   在所选区域购买的华为云主机
    >-   已接入所选区域的非华为云主机

4.  在“开启防护“对话框中，为指定的主机分配“防护配额“，如[图3](#fig20655720125915)所示。

    >![](public_sys-resources/icon-note.gif) **说明：** 
    >若您的主机使用的是Linux操作系统，您可以同时开启动态网页防篡改，动态网页防篡改开启后，需重启Tomcat才能使其生效。
    >若您未开启动态网页防篡改，后续您可以在“安装与配置“界面[手动开启](开启动态网页防篡改.md)。

    **图 3**  开启网页防篡改<a name="fig20655720125915"></a>  
    ![](figures/开启网页防篡改.png "开启网页防篡改")

    “防护配额“分配方式：

    -   随机分配：下拉框选择“随机选择配额“，系统优先为主机分发服务剩余时间较长的配额。
    -   指定分配：下拉框选择具体配额ID，您可以为主机分配指定的配额。
    -   批量分配：批量开启防护时，系统会随机为批量选择的主机分配配额。

5.  开启“网页防篡改”防护服务后，请在控制台上查看企业主机安全服务的开启状态。

    “网页防篡改版“开启后，旗舰版防护会同步开启。

    -   选择“网页防篡改  \>  防护列表“，目标主机所在行的“防护状态“为“开启“，且“版本/到期时间“为“网页防篡改版“，则表示网页防篡改版已开启。
    -   选择“企业主机安全  \>  主机管理  \>  云服务器“，目标主机所在行的“防护状态“为“开启“，且“版本/到期时间“为“旗舰版（网页防篡改赠送）“，则表示网页防篡改赠送的旗舰版已开启。


>![](public_sys-resources/icon-notice.gif) **须知：** 
>-   您也可以通过在“网页防篡改  \>  防护列表  \>  配额详情“页面，单击“绑定主机“，为主机绑定防护配额，HSS自动为主机开启网页防篡改防护。
>-   一个配额只能绑定一个主机，且只能绑定Agent在线的主机。
>-   开启网页防篡改后如果需要更新网站请先临时关闭网页防篡改，完成更新后再开启。否则会造成网站更新失败。
>-   关闭网页防篡改期间，您的网站不受保护，更新网页后，请及时开启网页防篡改。

## 相关操作<a name="section12525114195917"></a>

**关闭网页防篡改**

您可以在“网页防篡改  \>  防护列表“列表的“操作“列中，单击“关闭防护“，关闭对指定主机的网页防篡改防护。

关闭网页防篡改后，HSS会自动释放防护配额。您可将空闲的配额分配给其他主机继续使用或退订无需使用的配额，避免造成配额资源的浪费。

>![](public_sys-resources/icon-notice.gif) **须知：** 
>-   关闭网页防篡改防护服务前，请对主机执行全面的检测，处理已知风险并记录操作信息，避免运维失误，使您的主机遭受攻击。
>-   关闭网页防篡改防护服务后，网页应用被篡改的可能性将大大提高，请及时清理主机中的重要数据、关停主机中的重要业务并断开主机与外部网络的连接，避免因主机遭受攻击而承担不必要的损失。
>-   执行关闭网页防篡改操作后，防护目录下的文件将不再受“网页防篡改”功能的防护，建议您提前处理防护目录下的文档，再对文档执行暂停防护、编辑或删除的相关操作。
>-   执行关闭网页防篡改操作后，若您的文档不慎被删除，请在主机本地备份或远端主机的备份路径中查找。
>-   当用户关闭网页防篡改时会同步关闭旗舰版防护。

**解绑配额**

您可以在“网页防篡改  \>  防护列表  \>  配额详情“页面的“操作“列中，选择“更多  \>  解绑配额“，解绑配额后，该配额的使用状态将从“使用中“变更为“空闲“。HSS将自动关闭关联主机的网页防篡改防护。

您可将“空闲“的配额分配给其他主机继续使用或退订无需使用的配额，避免造成配额资源的浪费。

>![](public_sys-resources/icon-note.gif) **说明：** 
>当开启了网页防篡改的云主机被退订，该云主机绑定的配额不会自动释放。您可以通过解绑配额的方式，解除绑定的配额。

